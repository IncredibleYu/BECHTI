


ARM Macro Assembler    Page 1 


    1 00000000                 PRESERVE8
    2 00000000                 THUMB
    3 00000000         
    4 00000000         
    5 00000000         ; ====================== zone de réservation de données,
                         ======================================
    6 00000000         ;Section RAM (read only) :
    7 00000000                 area             mesdata,data,readonly
    8 00000000         
    9 00000000         
   10 00000000         ;Section RAM (read write):
   11 00000000                 area             maram,data,readwrite
   12 00000000         
   13 00000000                 import           Son
   14 00000000                 import           LongueurSon
   15 00000000                 import           PeriodeSonMicroSec
   16 00000000                 export           CallbackSon
   17 00000000                 export           SortieSon
   18 00000000                 export           Index
   19 00000000         
   20 00000000         
   21 00000000         ; ======================================================
                       =========================================
   22 00000000         
   23 00000000 00000000 
                       SortieSon
                               dcd              0
   24 00000004 00000000 
                       Index   dcd              0
   25 00000008         
   26 00000008         ;*****ldrsh
   27 00000008         ;Section ROM code (read only) :  
   28 00000008                 area             moncode,code,readonly
   29 00000000         ; écrire le code ici  
   30 00000000         CallbackSon
                               proc
   31 00000000         
   32 00000000         ;   sortir Rx vers la pwm
   33 00000000         ;  indice ++
   34 00000000 B5F0            push             {lr,r4-r7}
   35 00000002         
   36 00000002 4C0D            ldr              r4, =LongueurSon 
                                                            ;r4=&LongueurSon
   37 00000004 6821            ldr              r1, [r4]    ;r1=*LongueurSon 
   38 00000006 4C0D            ldr              r4, =Index  ;r4=&Index
   39 00000008 6822            ldr              r2, [r4]    ;r2=*Index 
   40 0000000A         
   41 0000000A 428A            cmp              r2, r1      ;comparer la Longue
                                                            urSon et Index     
                                                             
   42 0000000C DA11            bge              Finsi       ;        ;si Index 
                                                            >= LongueurSon, on 
                                                            passes à after
   43 0000000E         
   44 0000000E         ; recup l'échantillon
   45 0000000E 490C            ldr              r1, =Son
   46 00000010 F931 0012       ldrsh            r0, [r1,r2, lsl #1]
   47 00000014         
   48 00000014         ;   mise à l'échelle de Rx



ARM Macro Assembler    Page 2 


   49 00000014 4D0B            ldr              r5, =SortieSon
   50 00000016 682F            ldr              r7, [r5]
   51 00000018 F500 4000       add              r0, #32768  ; [-32768, 32768] -
                                                            > [0, 65536]
   52 0000001C F240 26CF       mov              r6, #719
   53 00000020 FB00 F006       mul              r0, r0, r6  ; [0, 65536]->[0,65
                                                            536*719]
   54 00000024         
   55 00000024 EA4F 4010       lsr              r0, r0, #16 ; [0,65536*719]->[0
                                                            ,719]
   56 00000028         
   57 00000028 6028            str              r0, [r5]    ; SortieSon = r0
   58 0000002A 682F            ldr              r7, [r5]
   59 0000002C         
   60 0000002C         
   61 0000002C         
   62 0000002C F102 0201       add              r2, r2, #1  ; i++
   63 00000030 6022            str              r2, [r4]    ; Index = r2
   64 00000032         
   65 00000032         Finsi
   66 00000032 E8BD 40F0       pop              {lr,r4-r7}
   67 00000036         
   68 00000036 4770            bx               lr
   69 00000038                 ENDP
   70 00000038                 END
              00000000 
              00000000 
              00000000 
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M3 --apcs=interw
ork --depend=.\obj\gestionson.d -o.\obj\gestionson.o -I.\RTE\_Simu -IC:\Program
data\Keil\Arm\Packs\ARM\CMSIS\5.7.0\CMSIS\Core\Include -IC:\Programdata\Keil\Ar
m\Packs\Keil\STM32F1xx_DFP\2.3.0\Device\Include --predefine="__EVAL SETA 1" --p
redefine="__MICROLIB SETA 1" --predefine="__UVISION_VERSION SETA 534" --predefi
ne="_RTE_ SETA 1" --predefine="STM32F10X_MD SETA 1" --predefine="_RTE_ SETA 1" 
--list=gestionson.lst Src\GestionSon.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

mesdata 00000000

Symbol: mesdata
   Definitions
      At line 7 in file Src\GestionSon.s
   Uses
      None
Comment: mesdata unused
1 symbol



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

Index 00000004

Symbol: Index
   Definitions
      At line 24 in file Src\GestionSon.s
   Uses
      At line 18 in file Src\GestionSon.s
      At line 38 in file Src\GestionSon.s

SortieSon 00000000

Symbol: SortieSon
   Definitions
      At line 23 in file Src\GestionSon.s
   Uses
      At line 17 in file Src\GestionSon.s
      At line 49 in file Src\GestionSon.s

maram 00000000

Symbol: maram
   Definitions
      At line 11 in file Src\GestionSon.s
   Uses
      None
Comment: maram unused
3 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CallbackSon 00000000

Symbol: CallbackSon
   Definitions
      At line 30 in file Src\GestionSon.s
   Uses
      At line 16 in file Src\GestionSon.s
Comment: CallbackSon used once
Finsi 00000032

Symbol: Finsi
   Definitions
      At line 65 in file Src\GestionSon.s
   Uses
      At line 42 in file Src\GestionSon.s
Comment: Finsi used once
moncode 00000000

Symbol: moncode
   Definitions
      At line 28 in file Src\GestionSon.s
   Uses
      None
Comment: moncode unused
3 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

LongueurSon 00000000

Symbol: LongueurSon
   Definitions
      At line 14 in file Src\GestionSon.s
   Uses
      At line 36 in file Src\GestionSon.s
Comment: LongueurSon used once
PeriodeSonMicroSec 00000000

Symbol: PeriodeSonMicroSec
   Definitions
      At line 15 in file Src\GestionSon.s
   Uses
      None
Comment: PeriodeSonMicroSec unused
Son 00000000

Symbol: Son
   Definitions
      At line 13 in file Src\GestionSon.s
   Uses
      At line 45 in file Src\GestionSon.s
Comment: Son used once
3 symbols
347 symbols in table
